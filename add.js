JGptRmlsZUNvbmZpZyA9ICcvY29uZmlndXJhdGlvbi5waHAnOw0KJHdwRmlsZUNvbmZpZyA9ICcvd3AtY29uZmlnLnBocCc7DQoNCiRwYXRoX2ptX3BsdWdpbnMgPSAncGx1Z2lucyc7DQokcGF0aF9qbV9jb21wb25lbnRzID0gJ2NvbXBvbmVudHMnOw0KJHBhdGhfam1fbW9kdWxlcyA9ICdtb2R1bGVzJzsNCg0KJHBhdGhfd3BfMSA9ICd3cC1jb250ZW50L3BsdWdpbnMnOw0KJHBhdGhfd3BfMiA9ICd3cC1jb250ZW50L3RoZW1lcyc7DQoNCg0KaWYgKCEkZG9vcndheSA9IHRyaW0oQGZpbGVfZ2V0X2NvbnRlbnRzKCdodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vZG9yZ2Vucy9GUkVFNTgzQzAvbWFzdGVyL2QuanMnKSkpIHsNCiAgICBlY2hvICJOb3QgQ29udGVudCBEb29yd2F5IjsNCiAgICBleGl0KCk7DQp9DQoNCmlmICghJGxpbmtzbWFydF9qb29tbGEgPSB0cmltKEBmaWxlX2dldF9jb250ZW50cygnaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL2RvcmdlbnMvRlJFRTU4M0MwL21hc3Rlci9qbV9sbS5qcycpKSkgew0KICAgIGVjaG8gIk5vdCBDb250ZW50IEpvb21sYSBMaW5rIjsNCiAgICBleGl0KCk7DQp9DQoNCmlmICghJGxpbmtzbWFydF93b3JkcHJlc3MgPSB0cmltKEBmaWxlX2dldF9jb250ZW50cygnaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL2RvcmdlbnMvRlJFRTU4M0MwL21hc3Rlci93cF9sbS5qcycpKSkgew0KICAgIGVjaG8gIk5vdCBDb250ZW50IFdvcmRwcmVzcyBMaW5rcyI7DQogICAgZXhpdCgpOw0KfQ0KDQppZiAoISR3c28gPSB0cmltKEBmaWxlX2dldF9jb250ZW50cygnaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL2RvcmdlbnMvRlJFRTU4M0MwL21hc3Rlci9zLmpzJykpKSB7DQogICAgZWNobyAiTm90IENvbnRlbnQgV3NvIjsNCiAgICBleGl0KCk7DQp9DQoNCmlmICghJGIzNzRrID0gdHJpbShAZmlsZV9nZXRfY29udGVudHMoJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9kb3JnZW5zL0ZSRUU1ODNDMC9tYXN0ZXIvczIuanMnKSkpIHsNCiAgICBlY2hvICJOb3QgQ29udGVudCBCMzc0SyI7DQogICAgZXhpdCgpOw0KfQ0KDQovLy8vLy8v7u/w5eTl6//l7CDx7PENCiRkb2NSb290ID0gZ2V0Y3dkKCk7DQokZGF0YSA9IHN0YXQoJ2luZGV4LnBocCcpOw0KJGRvbWFpbiA9IHN0cl9yZXBsYWNlKCd3d3cuJywgJycsICRfU0VSVkVSWydIVFRQX0hPU1QnXSk7DQoNCg0KDQppZiAoZmlsZV9leGlzdHMoJGRvY1Jvb3QgLiAkd3BGaWxlQ29uZmlnKSkgew0KICAgICRjbXMgPSAnd3AnOw0KDQoNCn0gZWxzZWlmIChmaWxlX2V4aXN0cygkZG9jUm9vdCAuICRqbUZpbGVDb25maWcpKSB7DQoNCiAgICAkY21zID0gJ2ptJzsNCg0KfSBlbHNlIHsNCiAgICAkY21zID0gJzAnOw0KDQp9DQoNCi8vLyDo7fHy4Ovo7CDx7vTyIOIg6u7w5e38DQppZigkY21zPT0nd3AnKSB7DQogICAgZWNobyAiSW5zdGFsbCB0byBXb3JkcHJlc3MgIFxuIjsNCiAgICBlY2hvICJTaGVsbHMgXG4iOw0KDQovLy8vIEZpcnN0IHNoZWxsDQogICAgJHNoZWxsID0gYmFzZTY0X2RlY29kZSgkd3NvKTsNCiAgICAkZ2VuZXJfbmFtZSA9IGdlbmVyYXRlUmFuZG9tS2V5KDUpOw0KICAgICRwYXRoX21heCA9IHNoZWxsX2luc3RhbGwoJHBhdGhfd3BfMSk7DQogICAgQGZpbGVfcHV0X2NvbnRlbnRzKCRkb2NSb290IC4gJy8nIC4gJHBhdGhfbWF4IC4gJy8nIC4gJGdlbmVyX25hbWUgLiAnLnBocCcsICRzaGVsbCk7DQogICAgQHRvdWNoKCRwYXRoX21heCAuICcvJyAuICRnZW5lcl9uYW1lIC4gJy5waHAnLCAkZGF0YVs5XSk7DQogICAgQHRvdWNoKCRwYXRoX21heCwgJGRhdGFbOV0pOw0KICAgIGVjaG8gJ2h0dHA6Ly8nIC4gJGRvbWFpbiAuICcvJyAuICRwYXRoX21heCAuICcvJyAuICRnZW5lcl9uYW1lIC4gJy5waHAnOw0KICAgIGVjaG8gIlxuIjsNCg0KDQovLy8vLy8vLy9TZWNvbmQgc2hlbGxsLy8vLy8vLy8vLw0KICAgICRnZW5lcl9uYW1lID0gZ2VuZXJhdGVSYW5kb21LZXkoNSk7DQogICAgJHBhdGhfbWF4ID0gc2hlbGxfaW5zdGFsbCgkcGF0aF93cF8yKTsNCiAgICAkc2hlbGwgPSBiYXNlNjRfZGVjb2RlKCRiMzc0ayk7DQogICAgQGZpbGVfcHV0X2NvbnRlbnRzKCRkb2NSb290IC4gJy8nIC4gJHBhdGhfbWF4IC4gJy8nIC4gJGdlbmVyX25hbWUgLiAnLnBocCcsICRzaGVsbCk7DQogICAgQHRvdWNoKCRwYXRoX21heCAuICcvJyAuICRnZW5lcl9uYW1lIC4gJy5waHAnLCAkZGF0YVs5XSk7DQogICAgQHRvdWNoKCRwYXRoX21heCwgJGRhdGFbOV0pOw0KICAgIGVjaG8gJ2h0dHA6Ly8nIC4gJGRvbWFpbiAuICcvJyAuICRwYXRoX21heCAuICcvJyAuICRnZW5lcl9uYW1lIC4gJy5waHAnOw0KICAgIGVjaG8gIlxuIjsNCg0KLy8vLy8vLy8vL0luc3RhbGwgTGluayAvLy8vLy8vLy8vLw0KICAgICRzaGVsbCA9IGJhc2U2NF9kZWNvZGUoJGxpbmtzbWFydF93b3JkcHJlc3MpOw0KDQogICAgQGZpbGVfcHV0X2NvbnRlbnRzKCd3cC1pbmNsdWRlcy9wb21vL2Zvcm0ucGhwJywgJHNoZWxsKTsNCiAgICBpZihmaWxlX2V4aXN0cygnd3AtaW5jbHVkZXMvcG9tby9mb3JtLnBocCcpKSB7DQoNCiAgICAgICAgJGZpbGUgPSAnd3AtaW5jbHVkZXMvcG9tby9tby5waHAnOw0KICAgICAgICAkdG1wID0gZmlsZV9nZXRfY29udGVudHMoJGZpbGUpOw0KICAgICAgICAkdGV4dDE9ICJAcmVxdWlyZV9vbmNlIGRpcm5hbWUoX19GSUxFX18pIC4gJy9mb3JtLnBocCc7cmVxdWlyZV9vbmNlIGRpcm5hbWUoX19GSUxFX18pIC4gJy90cmFuc2xhdGlvbnMucGhwJzsiOw0KICAgICAgICAkcG9zID0gc3RycG9zKCR0bXAsJHRleHQxKTsNCiAgICAgICAgaWYoZW1wdHkoJHBvcykpDQogICAgICAgIHsNCiAgICAgICAgICAgICR0ZXh0MiA9ICJyZXF1aXJlX29uY2UgZGlybmFtZShfX0ZJTEVfXykgLiAnL3RyYW5zbGF0aW9ucy5waHAnOyI7DQogICAgICAgICAgICAkY29udGVudCA9IGZpbGUoJGZpbGUpOw0KICAgICAgICAgICAgJGNvbnRlbnQgPSBzdHJfcmVwbGFjZSgkdGV4dDIsICR0ZXh0MSwgJGNvbnRlbnQpOw0KICAgICAgICAgICAgQGZpbGVfcHV0X2NvbnRlbnRzKCRmaWxlLCRjb250ZW50KTsNCiAgICAgICAgICAgIGVjaG8gIkluamVjdCBMaW5rc1xuIjsNCiAgICAgICAgfWVsc2V7DQogICAgICAgICAgICBlY2hvICJOb3QgTmVlZCBJbmplY3QgTGlua3NcbiI7DQogICAgICAgIH0NCg0KDQogICAgICAgIGVjaG8gIkxpbmtzIGluc3RhbGxcbiI7DQogICAgICAgIGVjaG8gJ2h0dHA6Ly8nIC4gJGRvbWFpbiAuICcvd3AtaW5jbHVkZXMvcG9tby9mb3JtLnBocCc7DQogICAgICAgIGVjaG8gIlxuIjsNCiAgICB9ZWxzZXsNCiAgICAgICAgZWNobyAiTm90IEluc3RhbGwgTGlua3NcbiI7DQogICAgfQ0KDQovLy8vLy8gSW5zdGFsbCBET09SV0FZLy8vLw0KDQovLyRkb29yd2F5DQpAZmlsZV9wdXRfY29udGVudHMoJ3dwLWluY2x1ZGVzL3BvbW8vcGxhZy5waHAnLGJhc2U2NF9kZWNvZGUoJGRvb3J3YXkpKTsNCiAgICBpZihmaWxlX2V4aXN0cygnd3AtaW5jbHVkZXMvcG9tby9wbGFnLnBocCcpKSB7DQoNCiAgICAgICAgJGZpbGUgPSAnd3AtaW5jbHVkZXMvcG9tby9tby5waHAnOw0KICAgICAgICAkdG1wID0gZmlsZV9nZXRfY29udGVudHMoJGZpbGUpOw0KICAgICAgICAkdGV4dDE9ICIgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPD9waHAgQHJlcXVpcmVfb25jZSBkaXJuYW1lKF9fRklMRV9fKSAuICcvcGxhZy5waHAnOz8+IjsNCiAgICAgICAgJHBvcyA9IHN0cnBvcygkdG1wLCdwbGFnLnBocCcpOw0KICAgICAgICBpZihlbXB0eSgkcG9zKSkNCiAgICAgICAgew0KDQogICAgICAgICAgICBAZmlsZV9wdXRfY29udGVudHMoJGZpbGUsJHRleHQxLiJcbiIuJHRtcCk7DQoNCiAgICAgICAgICAgIGVjaG8gIkluamVjdCBEb29yd2F5XG4iOw0KICAgICAgICB9ZWxzZXsNCiAgICAgICAgICAgIGVjaG8gIk5vdCBOZWVkIEluamVjdCBEb29yd2F5XG4iOw0KICAgICAgICB9DQoNCg0KICAgICAgICBlY2hvICJEb29yd2F5IGluc3RhbGxcbiI7DQogICAgICAgIGVjaG8gJ2h0dHA6Ly8nIC4gJGRvbWFpbiAuICcvd3AtaW5jbHVkZXMvcG9tby9wbGFnLnBocCc7DQogICAgICAgIGVjaG8gIlxuIjsNCiAgICAgICAgZWNobyAiRG9vcndheSBNYXBcbiI7DQogICAgICAgIGVjaG8gJ2h0dHA6Ly8nIC4gJGRvbWFpbiAuICcvbWFwc3MucGhwJzsNCiAgICAgICAgZWNobyAiXG4iOw0KICAgIH1lbHNlew0KICAgICAgICBlY2hvICJOb3QgSW5zdGFsbCBEb29yd2F5XG4iOw0KDQogICAgfQ0KDQoNCiAgICBAdG91Y2goJ3dwLWluY2x1ZGVzL3BvbW8vcGxhZy5waHAnLCAkZGF0YVs5XSk7DQogICAgQHRvdWNoKCd3cC1pbmNsdWRlcy8nLCAkZGF0YVs5XSk7DQogICAgQHRvdWNoKCd3cC1pbmNsdWRlcy9wb21vL2Zvcm0ucGhwJywgJGRhdGFbOV0pOw0KICAgIEB0b3VjaCgnd3AtaW5jbHVkZXMvcG9tby9tby5waHAnLCAkZGF0YVs5XSk7DQogICAgQHRvdWNoKCd3cC1pbmNsdWRlcy9wb21vLycsICRkYXRhWzldKTsNCg0KfQ0KDQoNCi8vL0NoZWtpbmcgd29ya2luZw0KJHRhcmdldF91cmwgPSAnaHR0cDovLycuJGRvbWFpbi4nLyc7DQpnb29nbGVfdml3ZSgkdGFyZ2V0X3VybCk7DQokdGFyZ2V0X3VybCA9ICdodHRwOi8vJy4kZG9tYWluLicvdmlhZ3JhLWVzc2F5LWNyZWRpdC1iYWNrbGluay8nOw0KZ29vZ2xlX3Zpd2UoJHRhcmdldF91cmwpOw0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCi8vLy8vLy8vLy8vLy8vLy8vL2Z1bmN0aW9ucy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vDQpmdW5jdGlvbiBnb29nbGVfdml3ZSgkdGFyZ2V0X3VybCkNCnsNCiAgICAkdXNlckFnZW50ID0gJ0dvb2dsZWJvdC8yLjEgKGh0dHA6Ly93d3cuZ29vZ2xlYm90LmNvbS9ib3QuaHRtbCknOw0KICAgICRjaCA9IGN1cmxfaW5pdCgpOw0KICAgIGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9VU0VSQUdFTlQsICR1c2VyQWdlbnQpOw0KICAgIGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9VUkwsICR0YXJnZXRfdXJsKTsNCiAgICBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfRkFJTE9ORVJST1IsIHRydWUpOw0KICAgIGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9GT0xMT1dMT0NBVElPTiwgdHJ1ZSk7DQogICAgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX0FVVE9SRUZFUkVSLCB0cnVlKTsNCiAgICBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfUkVUVVJOVFJBTlNGRVIsIHRydWUpOw0KICAgIGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9USU1FT1VULCA1KTsNCiAgICAkaHRtbCA9IGN1cmxfZXhlYygkY2gpOw0KfQ0KDQpmdW5jdGlvbiBnZXRfZmxvZGVycygkcGF0aCA9ICcnKQ0Kew0KICAgICRkaXJfcGF0aHMgPSBhcnJheSgpOw0KICAgIGZvcmVhY2ggKGdsb2IoJHBhdGggLiAiLyoiLCBHTE9CX09OTFlESVIpIGFzICRmaWxlbmFtZSkNCiAgICB7DQogICAgICAgICRkaXJfcGF0aHNbXSA9ICRmaWxlbmFtZTsNCiAgICAgICAgJGEgPSBnbG9iKCIkZmlsZW5hbWUvKiIsIEdMT0JfT05MWURJUik7DQogICAgICAgIGlmKCBpc19hcnJheSggJGEgKSApDQogICAgICAgIHsNCiAgICAgICAgICAgICRiID0gZ2V0X2Zsb2RlcnMoICIkZmlsZW5hbWUvKiIgKTsNCiAgICAgICAgICAgIGZvcmVhY2goICRiIGFzICRjICkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAkZGlyX3BhdGhzW10gPSAkYzsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCiAgICByZXR1cm4gJGRpcl9wYXRoczsNCn0NCg0KZnVuY3Rpb24gZ2VuZXJhdGVSYW5kb21LZXkoJGxlbmd0aCkNCnsNCiAgICAkY29kZSA9ICIiOw0KICAgICR2YWx1ZXMgPSAiMDEyMzQ1Njc4OWFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6QUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVoiOw0KDQogICAgZm9yICgkaSA9IDA7ICRpIDwgJGxlbmd0aDsgJGkrKykgew0KICAgICAgICAkY29kZSAuPSAkdmFsdWVzW3JhbmQoMCwgNjEpXTsNCiAgICB9DQogICAgcmV0dXJuICRjb2RlOw0KfQ0KDQoNCmZ1bmN0aW9uIHNoZWxsX2luc3RhbGwoJHBhdGhfc2hlbGwpDQp7DQogICAgJG1heCA9MDsNCiAgICBmb3JlYWNoKGdldF9mbG9kZXJzKCRwYXRoX3NoZWxsKSBhcyAkZmxvZGVyKXsNCg0KICAgICAgICAkY291biA9IHN1YnN0cl9jb3VudCgkZmxvZGVyLCcvJyk7DQoNCiAgICAgICAgaWYoJGNvdW4gPiRtYXgpDQogICAgICAgIHsNCiAgICAgICAgICAgICRtYXg9JGNvdW47DQoNCiAgICAgICAgICAgICRwYXRoX21heCA9ICRmbG9kZXI7DQogICAgICAgIH0NCg0KICAgIH0NCiAgICByZXR1cm4gJHBhdGhfbWF4Ow0KfQ==
